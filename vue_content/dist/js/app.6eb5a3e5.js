(function(e){function t(t){for(var n,r,i=t[0],c=t[1],l=t[2],d=0,m=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&m.push(a[r][0]),a[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(m.length)m.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],n=!0,i=1;i<s.length;i++){var c=s[i];0!==a[c]&&(n=!1)}n&&(o.splice(t--,1),e=r(r.s=s[0]))}return e}var n={},a={app:0},o=[];function r(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=n,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},1318:function(e,t,s){e.exports=s.p+"img/helpRepayment.87a7b2d3.png"},"2ad6":function(e,t,s){},"43cf":function(e,t,s){"use strict";s("b77f")},4520:function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var n=s("2b0e"),a=function(){var e=this,t=this,s=t.$createElement,n=t._self._c||s;return n("v-app",[n("userRoot",{on:{clickHelpButton:function(){t.help_flag=!0}}}),t.help_flag?n("helpModal",{on:{closeHelp:function(){e.help_flag=!1}}}):t._e(),n("div",{style:t.padding_styles}),n("myFooter",{on:{resizeEvent:t.footerPadding}})],1)},o=[],r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.shareLinkFlag?s("shareLinkModal",{attrs:{shareLink:e.shareLink},on:{closeModal:function(t){e.shareLinkFlag=!1}}}):e._e(),e.passwordModalFlag?s("passwordModal",{attrs:{sessionName:e.loadSessionName},on:{closeModal:function(t){e.passwordModalFlag=!1},inputPasswordEvent:e.saveEncryptedPasswordToCookieAndUpdate}}):e._e(),s("v-container",[s("appBar",{attrs:{userNameList:e.userNameList},on:{appendUserEvent:e.appendUser,repaymentEvent:e.calcRepayment,clickHelpButton:function(t){return e.$emit("clickHelpButton")},shareEvent:e.uploadAndShare,loadEvent:e.loadUserInfo,disconnectEvent:function(t){return e.updateUserInfo()}}}),s("v-row",{staticClass:"pa-2"},e._l(e.userIterator,(function(t){return s("div",{key:t},[s("userInfo",{attrs:{userName:e.userNameList[t-1],userPayedAmount:e.paymentList[t-1],averagePayment:e.averagePayment},on:{userPayEvent:e.calcTotalPayment,deleteUserEvent:e.deleteUser}})],1)})),0),s("div",{staticClass:"pa-6"},[s("p",{class:{disabledContent:e.userNameList.length<2}},[e._v(" 総額："+e._s(e.totalPayment)+"円 ")]),s("p",{class:{disabledContent:e.userNameList.length<2}},[e._v(" 一人あたり："+e._s(e.averagePayment)+"円 ")]),e.userNameList.length>=2&&e.hasFraction?s("p",{class:{disabledContent:e.userNameList.length<2}},[e._v(" 誰かが「"+e._s(e.userNameList.length)+"で割って"+e._s(e.mod)+"余る数字」円払うと端数がなくなります ")]):e._e(),e.userNameList.length<2||!e.hasFraction?s("p",{class:{disabledContent:e.userNameList.length<2}},[e._v(" 端数はありません ")]):e._e()])],1)],1)},i=[],c=s("1da1"),l=(s("96cf"),s("d3b7"),s("b0c0"),s("a434"),s("ac1f"),s("1276"),s("d81d"),s("a9e3"),s("bc3a")),u=s.n(l),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-sheet",{staticClass:"ma-2",attrs:{color:"#FFF9C4",elevation:"6",rounded:"true"}},[n("v-container",[n("v-row",{staticClass:"ma-1",attrs:{id:"id_userName"}},[n("span",[e._v(e._s(e.userName))]),n("v-spacer"),n("v-btn",{attrs:{icon:""},on:{click:e.deleteConfirm}},[n("v-icon",[e._v("mdi-close-circle")])],1),e.deleteConfirmFlag?n("deleteConfirmModal",{attrs:{deletedUserName:e.userName},on:{deleteConfirmEvent:e.deleteUser,deleteCancelEvent:e.cancelDeleting}}):e._e()],1),n("v-row",{staticClass:"ml-1",attrs:{align:"center"}},[n("v-col",{staticClass:"pa-1"},[n("moneyTextField",{model:{value:e.paymentAmount,callback:function(t){e.paymentAmount=e._n(t)},expression:"paymentAmount"}})],1),n("v-col",{staticClass:"pa-1"},[n("v-btn",{attrs:{small:"",color:"warning",fab:"",dark:""},on:{click:e.addPaymentAmount}},[n("v-img",{attrs:{src:s("7a75"),width:"25",height:"25",contain:""}})],1)],1)],1),n("v-row",{staticClass:"ml-1"},[n("v-col",{staticClass:"pa-1"},[n("span",[e._v("累計支払金額："+e._s(e._f("floorToTenths")(e.userPayedAmount))+"円")])])],1),n("v-row",{staticClass:"ml-1"},[n("v-col",{staticClass:"pa-1 mb-3"},[e.userSplitPayment<0?n("span",{staticClass:"class_loss"},[e._v(" "+e._s(e._f("floorToTenths")(Math.abs(e.userSplitPayment)))+"円 立て替え中 ")]):e.userSplitPayment>0?n("span",{staticClass:"class_profit"},[e._v(" "+e._s(e._f("floorToTenths")(Math.abs(e.userSplitPayment)))+"円 支払うと割り勘 ")]):n("span",{staticClass:"class_just"},[e._v(" ちょうど一人分の金額を払っています ")])])],1)],1)],1)},m=[],p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-text-field",{attrs:{type:"number",prefix:"￥",label:"金額",dence:"",solo:"","hide-details":"",value:e.value},on:{input:function(t){return e.$emit("input",t)}}})},h=[],f={name:"moneyTextField",props:["value"]},v=f,y=(s("f909"),s("2877")),w=s("6544"),g=s.n(w),b=s("8654"),k=Object(y["a"])(v,p,h,!1,null,null,null),_=k.exports;g()(k,{VTextField:b["a"]});var N=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal_overlay"},[s("v-card",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.cancelDeleting,expression:"cancelDeleting"}],staticClass:"modal_contents",attrs:{color:"white"}},[s("v-container",[s("v-row",{attrs:{justify:"center"}},[s("p",[e._v(e._s(e.deletedUserName)+" さんを削除します。")])]),s("v-row",{attrs:{justify:"center"}},[s("v-btn",{on:{click:e.cancelDeleting}},[e._v(" キャンセル ")]),s("v-btn",{on:{click:e.confirmDeleting}},[s("v-icon",[e._v(" mdi-delete ")])],1)],1)],1)],1)],1)},C=[],x={name:"deleteConfirmModal",data:function(){return{}},props:["deletedUserName"],methods:{confirmDeleting:function(){this.$emit("deleteConfirmEvent",this.deletedUserName)},cancelDeleting:function(){this.$emit("deleteCancelEvent")}}},P=x,L=s("8336"),E=s("b0af"),$=s("a523"),F=s("132d"),V=s("0fd9"),T=s("269a"),j=s.n(T),S=s("a293"),A=Object(y["a"])(P,N,C,!1,null,null,null),U=A.exports;g()(A,{VBtn:L["a"],VCard:E["a"],VContainer:$["a"],VIcon:F["a"],VRow:V["a"]}),j()(A,{ClickOutside:S["a"]});var I={name:"userInfo",components:{moneyTextField:_,deleteConfirmModal:U},props:["userName","averagePayment","userPayedAmount"],data:function(){return{paymentAmount:"",deleteConfirmFlag:!1}},computed:{userSplitPayment:function(){return this.averagePayment-this.userPayedAmount}},methods:{addPaymentAmount:function(){var e=Math.floor(this.paymentAmount);this.$emit("userPayEvent",{name:this.userName,amount:e}),this.paymentAmount=""},deleteUser:function(){this.deleteConfirmFlag=!1,this.$emit("deleteUserEvent",this.userName)},deleteConfirm:function(){this.deleteConfirmFlag=!0},cancelDeleting:function(){this.deleteConfirmFlag=!1}},filters:{floorToTenths:function(e){return Math.floor(10*e)/10}}},M=I,K=(s("f634"),s("62ad")),O=s("adda"),R=s("8dd9"),B=s("2fa4"),D=Object(y["a"])(M,d,m,!1,null,"34093268",null),H=D.exports;g()(D,{VBtn:L["a"],VCol:K["a"],VContainer:$["a"],VIcon:F["a"],VImg:O["a"],VRow:V["a"],VSheet:R["a"],VSpacer:B["a"]});var z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("header",[s("v-app-bar",{attrs:{app:"",fixed:"",color:"orange","elevate-on-scroll":""}},[e.$vuetify.breakpoint.sm||e.$vuetify.breakpoint.xs?s("v-app-bar-nav-icon",{on:{click:function(t){e.drawer=!0}}}):e._e(),s("v-toolbar-title",[e._v("和割勘")]),e.$vuetify.breakpoint.sm||e.$vuetify.breakpoint.xs?e._e():s("v-tabs",e._l(e.menuList,(function(t){return s("v-tab",{key:t.name,attrs:{to:t.url}},[e._v(" "+e._s(t.name)+" ")])})),1),s("v-spacer"),s("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$emit("clickHelpButton")}}},[s("v-icon",[e._v("mdi-help-circle-outline")])],1)],1),s("v-navigation-drawer",{attrs:{fixed:"",temporary:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[s("v-list",{attrs:{nav:"",dense:""}},[s("v-list-item-group",e._l(e.menuList,(function(t){return s("v-list-item",{key:t.name,attrs:{to:t.url}},[s("v-list-item-title",[e._v(e._s(t.name))])],1)})),1)],1)],1)],1),s("div",{staticClass:"pa-6"}),s("router-view",{attrs:{userNameList:e.userNameList},on:{appendUserEvent:e.appendEvent,repaymentEvent:e.repaymentEvent,shareEvent:e.shareEvent,loadEvent:e.loadEvent,disconnectEvent:function(t){return e.$emit("disconnectEvent")}}})],1)},q=[],J={name:"appBar",data:function(){return{drawer:!1,menuList:[{name:"ユーザー追加",url:"/"},{name:"受け渡し",url:"/repaymentForm"},{name:"共有 / 読み込み",url:"/shareAndLoadForm"}]}},props:["userNameList"],methods:{appendEvent:function(e){this.$emit("appendUserEvent",e)},repaymentEvent:function(e){this.$emit("repaymentEvent",e)},shareEvent:function(e){this.$emit("shareEvent",e)},loadEvent:function(e){this.$emit("loadEvent",e)}}},W=J,X=(s("e5b8"),s("40dc")),G=s("5bc1"),Q=s("8860"),Y=s("da13"),Z=s("1baa"),ee=s("5d23"),te=s("f774"),se=s("71a3"),ne=s("fe57"),ae=s("2a7f"),oe=Object(y["a"])(W,z,q,!1,null,"62d54ee7",null),re=oe.exports;g()(oe,{VAppBar:X["a"],VAppBarNavIcon:G["a"],VBtn:L["a"],VIcon:F["a"],VList:Q["a"],VListItem:Y["a"],VListItemGroup:Z["a"],VListItemTitle:ee["b"],VNavigationDrawer:te["a"],VSpacer:B["a"],VTab:se["a"],VTabs:ne["a"],VToolbarTitle:ae["a"]});var ie=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal_overlay"},[s("v-card",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeModal,expression:"closeModal"}],staticClass:"modal_contents",attrs:{color:"white"}},[s("v-container",[s("v-row",{attrs:{justify:"end"}},[s("v-btn",{attrs:{icon:""},on:{click:e.closeModal}},[s("v-icon",[e._v("mdi-close-circle")])],1)],1),s("v-row",[s("p",[e._v(e._s(e.shareLink))]),s("textCopyButton",{attrs:{text:e.shareLink}})],1)],1)],1)],1)},ce=[],le=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-icon",{on:{click:function(t){return e.copyToClipboard(e.text)}}},[e._v("mdi-content-copy")])},ue=[],de={name:"textCopyButton",components:{},data:function(){return{}},props:["text"],methods:{copyToClipboard:function(e){navigator.clipboard.writeText(e).then((function(){console.log("copied!")})).catch((function(e){console.error(e)}))}}},me=de,pe=Object(y["a"])(me,le,ue,!1,null,null,null),he=pe.exports;g()(pe,{VIcon:F["a"]});var fe={name:"shareLinkModal",components:{textCopyButton:he},data:function(){return{}},props:["shareLink"],methods:{closeModal:function(){this.$emit("closeModal")}}},ve=fe,ye=Object(y["a"])(ve,ie,ce,!1,null,null,null),we=ye.exports;g()(ye,{VBtn:L["a"],VCard:E["a"],VContainer:$["a"],VIcon:F["a"],VRow:V["a"]}),j()(ye,{ClickOutside:S["a"]});var ge=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal_overlay"},[s("v-card",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeModal,expression:"closeModal"}],staticClass:"modal_contents",attrs:{color:"white"}},[s("v-container",[s("v-row",{attrs:{justify:"end"}},[s("v-btn",{attrs:{icon:""},on:{click:e.closeModal}},[s("v-icon",[e._v("mdi-close-circle")])],1)],1),s("v-row",[s("span",[e._v(" "+e._s(e.sessionName)+"を読み込みます。パスワードを入力してください。 ")]),s("span",[e._v(" （「共有」していないデータは破棄されます。） ")])]),s("v-row",[s("passwordTextField",{attrs:{enablePassword:!0},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),s("v-row",[s("v-btn",{on:{click:e.closeModal}},[e._v("キャンセル")]),s("v-btn",{on:{click:function(t){return e.$emit("inputPasswordEvent",e.password)}}},[e._v("決定")])],1)],1)],1)],1)},be=[],ke=s("5fb0"),_e=s.n(ke),Ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-text-field",{attrs:{"append-icon":e.show?"mdi-eye":"mdi-eye-off",rules:[e.rules.required,e.rules.min8],type:e.show?"text":"password",label:"パスワード",disabled:!e.enablePassword,value:e.value},on:{"click:append":function(t){e.show=!e.show},input:function(t){return e.$emit("input",t)}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},Ce=[],xe={name:"passwordTextField",props:["value","enablePassword"],data:function(){return{show:!1,rules:{required:function(e){return!!e||"パスワードを入力してください"},min8:function(e){return e.length>=8||"8文字以上の文字列を入力してください"}}}}},Pe=xe,Le=(s("f5df1"),Object(y["a"])(Pe,Ne,Ce,!1,null,null,null)),Ee=Le.exports;g()(Le,{VTextField:b["a"]});var $e={name:"passwordModal",components:{passwordTextField:Ee},data:function(){return{password:""}},props:["sessionName"],methods:{closeModal:function(){this.$cookies.remove(_e.a.sessionNameKey),this.$emit("closeModal")}}},Fe=$e,Ve=Object(y["a"])(Fe,ge,be,!1,null,null,null),Te=Ve.exports;g()(Ve,{VBtn:L["a"],VCard:E["a"],VContainer:$["a"],VIcon:F["a"],VRow:V["a"]}),j()(Ve,{ClickOutside:S["a"]});var je={name:"userRoot",components:{userInfo:H,appBar:re,shareLinkModal:we,passwordModal:Te},data:function(){return{userNameList:[],paymentList:[],shareLink:"",shareLinkFlag:!1,loadSessionName:"",passwordModalFlag:!1}},computed:{averagePayment:function(){return 0===this.userNameList.length?0:this.totalPayment/this.userNameList.length},userIterator:function(){for(var e=[],t=1;t<=this.userNameList.length;t++)e.push(t);return e},mod:function(){return 0!=this.userNameList.length?this.userNameList.length-this.totalPayment%this.userNameList.length:0},hasFraction:function(){return this.totalPayment%this.userNameList.length!==0},totalPayment:function(){for(var e=0,t=0;t<this.paymentList.length;t++)e+=this.paymentList[t];return e},existSessionNameCookie:function(){return this.$cookies.isKey(_e.a.sessionNameKey)&&""!==this.$cookies.get(_e.a.sessionNameKey)},existPasswordCookie:function(){return this.$cookies.isKey(_e.a.passwordKey)&&""!==this.$cookies.get(_e.a.passwordKey)}},methods:{appendUser:function(e){if(this.userNameList.push(e),this.paymentList.push(0),this.existSessionNameCookie&&this.existPasswordCookie){var t=this.$cookies.get(_e.a.sessionNameKey),s=this.$cookies.get(_e.a.passwordKey),n={sessionName:t,encryptedPassword:s,userName:e},a={method:"post",url:"dbAPI/appendUser",responseType:"json",headers:{"Content-Type":"application/json"},data:n},o=this;u()(a).then((function(e){console.log(e),e.result===_e.a.success?o.updateUserInfoFromDB(t):e.data.result===_e.a.wrongPassword&&o.wrongPasswordProcess()})).catch((function(e){o.$cookies.remove(_e.a.sessionNameKey),console.log(e)})).finally((function(){o=null}))}},calcTotalPayment:function(e){var t=this.userNameList.indexOf(e.name);if(n["a"].set(this.paymentList,t,this.paymentList[t]+e.amount),this.existSessionNameCookie&&this.existPasswordCookie){var s=this.$cookies.get(_e.a.sessionNameKey),a=this.$cookies.get(_e.a.passwordKey),o={sessionName:s,encryptedPassword:a,userName:e.name,paymentAmount:e.amount},r={method:"post",url:"dbAPI/updatePayment",responseType:"json",headers:{"Content-Type":"application/json"},data:o},i=this;u()(r).then((function(e){e===_e.a.success?i.updateUserInfoFromDB(s):e.data.result===_e.a.wrongPassword&&i.wrongPasswordProcess()})).catch((function(e){i.$cookies.remove(_e.a.sessionNameKey),console.log(e)})).finally((function(){i=null}))}},calcRepayment:function(e){var t=this.userNameList.indexOf(e.payer),s=this.userNameList.indexOf(e.receiver);if(n["a"].set(this.paymentList,t,this.paymentList[t]+e.amount),n["a"].set(this.paymentList,s,this.paymentList[s]-e.amount),this.existSessionNameCookie&&this.existPasswordCookie){var a=this.$cookies.get(_e.a.sessionNameKey),o=this.$cookies.get(_e.a.passwordKey),r={sessionName:a,encryptedPassword:o,payer:e.payer,receiver:e.receiver,paymentAmount:e.amount},i={method:"post",url:"dbAPI/repayment",responseType:"json",headers:{"Content-Type":"application/json"},data:r},c=this;u()(i).then((function(e){e===_e.a.success?c.updateUserInfoFromDB(a):e.data.result===_e.a.wrongPassword&&c.wrongPasswordProcess()})).catch((function(e){c.$cookies.remove(_e.a.sessionNameKey),console.log(e)})).finally((function(){c=null}))}},deleteUser:function(e){var t=this.userNameList.indexOf(e);if(this.userNameList.splice(t,1),this.paymentList.splice(t,1),this.existSessionNameCookie&&this.existPasswordCookie){var s=this.$cookies.get(_e.a.sessionNameKey),n=this.$cookies.get(_e.a.passwordKey),a={sessionName:s,encryptedPassword:n,userName:e},o={method:"post",url:"dbAPI/deleteUser",responseType:"json",headers:{"Content-Type":"application/json"},data:a},r=this;u()(o).then((function(e){e===_e.a.success?r.updateUserInfoFromDB(s):e.data.result===_e.a.wrongPassword&&r.wrongPasswordProcess()})).catch((function(e){r.$cookies.remove(_e.a.sessionNameKey),console.log(e)})).finally((function(){r=null}))}},uploadAndShare:function(e){var t={sessionName:e.sessionName,password:e.password,userNameList:this.userNameList,paymentList:this.paymentList},s={method:"post",url:"dbAPI/resisterSession",responseType:"json",headers:{"Content-Type":"application/json"},data:t},n=this;u()(s).then((function(t){t.data.result===_e.a.success&&(n.shareLink=t.data.shareLink,n.shareLinkFlag=!0,n.$cookies.set(_e.a.sessionNameKey,e.sessionName),n.saveEncryptedPasswordToCookieAndUpdate(e.password))})).catch((function(e){console.log(e)})).finally((function(){n=null}))},loadUserInfo:function(e){this.$cookies.remove(_e.a.passwordKey),window.location.href=_e.a.appURL+"?sessionName="+e},updateUserInfoFromCookie:function(){if(!this.$cookies.isKey(_e.a.userNameListKey)||!this.$cookies.isKey(_e.a.paymentListKey))return this.userNameList=[],void(this.paymentList=[]);var e=this.$cookies.get(_e.a.userNameListKey),t=this.$cookies.get(_e.a.paymentListKey);if(null===e||null===t)return this.userNameList=[],this.paymentList=[],this.$cookies.remove(_e.a.userNameListKey),void this.$cookies.remove(_e.a.paymentListKey);this.userNameList=e.split(",");var s=t.split(",");this.paymentList=s.map((function(e){return Number(e)}))},setUserInfoToCookie:function(){this.$cookies.set("userNameList",this.userNameList),this.$cookies.set("paymentList",this.paymentList)},wrongPasswordProcess:function(){alert(_e.a.wrongPasswordMessage),this.$cookies.remove(_e.a.passwordKey),this.updateUserInfo()},updateUserInfoFromDB:function(e){var t={method:"post",url:"dbAPI/getUserInfo",responseType:"json",headers:{"Content-Type":"application/json"},data:{sessionName:e,encryptedPassword:this.$cookies.get(_e.a.passwordKey)}},s=this;u()(t).then((function(e){console.log(e.data.result),e.data.result===_e.a.success?(s.userNameList=e.data.userNameList,s.paymentList=e.data.paymentList):e.data.result===_e.a.wrongPassword&&s.wrongPasswordProcess()})).catch((function(e){s.$cookies.remove(_e.a.sessionNameKey),console.log(e)})).finally((function(){s=null}))},updateUserInfoFromDBWithoutPassword:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var n,a,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return t.passwordModalFlag=!1,s.next=3,t.encrypt(_e.a.throughPassword);case 3:n=s.sent,a={method:"post",url:"dbAPI/getUserInfo",responseType:"json",headers:{"Content-Type":"application/json"},data:{sessionName:e,encryptedPassword:n}},o=t,u()(a).then((function(e){console.log(e.data.result),o.$cookies.set(_e.a.passwordKey,n),e.data.result===_e.a.success?(o.userNameList=e.data.userNameList,o.paymentList=e.data.paymentList):e.data.result===_e.a.wrongPassword&&o.wrongPasswordProcess()})).catch((function(e){o.$cookies.remove(_e.a.sessionNameKey),console.log(e)})).finally((function(){o=null}));case 7:case"end":return s.stop()}}),s)})))()},updateUserInfo:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$route.query.sessionName,s=void 0!==t&&""!==t,s||this.existSessionNameCookie){e.next=6;break}return this.updateUserInfoFromCookie(),this.$cookies.remove(_e.a.passwordKey),e.abrupt("return");case 6:return s?(this.$cookies.set(_e.a.sessionNameKey,t),this.loadSessionName=t):this.existSessionNameCookie&&(this.loadSessionName=this.$cookies.get(_e.a.sessionNameKey)),e.next=9,this.checkExistPassword(this.loadSessionName);case 9:n=e.sent,n?this.$cookies.isKey(_e.a.passwordKey)?this.updateUserInfoFromDB(this.loadSessionName):this.passwordModalFlag=!0:this.updateUserInfoFromDBWithoutPassword(this.loadSessionName);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),checkExistPassword:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={sessionName:e},n={method:"post",url:"dbAPI/checkExistPassword",responseType:"json",headers:{"Content-Type":"application/json"},data:s},a=!0,t.next=5,u()(n).then((function(e){e.data.result===_e.a.success&&(a=e.data.existPassword)})).catch((function(e){console.log(e)}));case 5:return t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)})))()},saveEncryptedPasswordToCookieAndUpdate:function(e){this.passwordModalFlag=!1;var t={method:"post",url:"dbAPI/encryptPassword",responseType:"json",headers:{"Content-Type":"application/json"},data:{password:e}},s=this;u()(t).then((function(e){s.$cookies.set(_e.a.passwordKey,e.data.encryptedPassword),s.updateUserInfo()})).catch((function(e){console.log(e)})).finally((function(){s=null}))},encrypt:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s="",n={method:"post",url:"dbAPI/encryptPassword",responseType:"json",headers:{"Content-Type":"application/json"},data:{password:e}},t.next=4,u()(n).then((function(e){e.result===_e.a.success&&(s=e.encryptedText)})).catch((function(e){console.log(e)}));case 4:return t.abrupt("return",s);case 5:case"end":return t.stop()}}),t)})))()}},updated:function(){this.$nextTick((function(){this.setUserInfoToCookie()}))},mounted:function(){this.$nextTick((function(){this.updateUserInfo()}))}},Se=je,Ae=(s("a35e"),Object(y["a"])(Se,r,i,!1,null,"34610630",null)),Ue=Ae.exports;g()(Ae,{VContainer:$["a"],VRow:V["a"]});var Ie=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-footer",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],ref:"footer",attrs:{color:"#666",absolute:"",padless:""}},[s("v-container",[s("v-row",[s("v-col",{attrs:{cols:"4"}}),s("v-col",{staticClass:"footer_centering",attrs:{cols:"4"}},[s("strong",{staticClass:"white--text"},[e._v("wa-warikan")])]),s("v-col",{staticClass:"footer_centering",attrs:{cols:"4"}})],1)],1)],1)},Me=[],Ke={data:function(){return{icons:["mdi-home","mdi-email","mdi-calendar"]}},computed:{},methods:{onResize:function(){var e=this.$el.getBoundingClientRect().height;this.$emit("resizeEvent",e)}}},Oe=Ke,Re=(s("c8a3"),s("553a")),Be=s("dc22"),De=Object(y["a"])(Oe,Ie,Me,!1,null,"9072ace8",null),He=De.exports;g()(De,{VCol:K["a"],VContainer:$["a"],VFooter:Re["a"],VRow:V["a"]}),j()(De,{Resize:Be["a"]});var ze=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal_overlay"},[s("v-card",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeHelp,expression:"closeHelp"}],staticClass:"modal_contents",attrs:{color:"white"}},[s("v-container",[s("v-row",{attrs:{justify:"end"}},[s("v-btn",{attrs:{icon:""},on:{click:e.closeHelp}},[s("v-icon",[e._v("mdi-close-circle")])],1)],1),s("v-row",{attrs:{justify:"center"}},[s("helpCarousel")],1)],1)],1)],1)},qe=[],Je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-carousel",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},[n("v-carousel-item",[n("div",{staticClass:"pa-4"},[n("h2",{staticClass:"pa-2",staticStyle:{"background-color":"orange"}},[e._v("概要")]),n("v-sheet",{staticClass:"ma-2",attrs:{height:"100%",tile:""}},[n("ol",[n("li",[e._v(" レジャー中「みんなで合計xxx円」という支払いは割り勘しない ")]),n("li",[e._v(" 代わりに各人の支払額をメモ（支払額が少ない人が払うとなおよし） ")]),n("li",[e._v(" レジャーの終わりに最終的な差額でお金のやりとりをする ")]),n("li",[e._v(" トータル割り勘成立！ ")])])])],1)]),n("v-carousel-item",{staticStyle:{"justify-content":"center"}},[n("h2",{staticClass:"pa-2",staticStyle:{"background-color":"orange"}},[e._v(" 1. 割勘するメンバーを追加 ")]),n("p",{staticClass:"ma-2",staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:s("b0e3"),width:"100%"}})])]),n("v-carousel-item",{staticStyle:{"justify-content":"center"}},[n("h2",{staticClass:"pa-2",staticStyle:{"background-color":"orange"}},[e._v(" 2. 各メンバーの支払い額を記録 ")]),n("p",{staticClass:"ma-2",staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:s("92c1"),width:"100%"}})])]),n("v-carousel-item",{staticStyle:{"justify-content":"center"}},[n("h2",{staticClass:"pa-2",staticStyle:{"background-color":"orange"}},[e._v(" 3. 表示される額の受け渡しで割勘！ ")]),n("p",{staticClass:"ma-2",staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:s("1318"),width:"100%"}})])])],1)},We=[],Xe={name:"helpCarousel",data:function(){return{model:0,colors:["primary","secondary","yellow darken-2","red","orange"]}}},Ge=Xe,Qe=s("5e66"),Ye=s("3e35"),Ze=Object(y["a"])(Ge,Je,We,!1,null,null,null),et=Ze.exports;g()(Ze,{VCarousel:Qe["a"],VCarouselItem:Ye["a"],VSheet:R["a"]});var tt={name:"helpModal",components:{helpCarousel:et},data:function(){return{}},props:[""],methods:{closeHelp:function(){this.$emit("closeHelp")}}},st=tt,nt=Object(y["a"])(st,ze,qe,!1,null,null,null),at=nt.exports;g()(nt,{VBtn:L["a"],VCard:E["a"],VContainer:$["a"],VIcon:F["a"],VRow:V["a"]}),j()(nt,{ClickOutside:S["a"]});var ot={name:"App",components:{userRoot:Ue,myFooter:He,helpModal:at},data:function(){return{padding_styles:"",help_flag:!1}},methods:{footerPadding:function(e){this.padding_styles={"padding-top":e+"px"}}}},rt=ot,it=(s("034f"),s("7496")),ct=Object(y["a"])(rt,a,o,!1,null,null,null),lt=ct.exports;g()(ct,{VApp:it["a"]});var ut=s("f309");n["a"].use(ut["a"]);var dt=new ut["a"]({}),mt=s("8c4f"),pt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",[s("v-row",{attrs:{align:"center"}},[s("v-col",[s("userTextField",{model:{value:e.inputtedUserName,callback:function(t){e.inputtedUserName=t},expression:"inputtedUserName"}})],1),s("v-col",[s("v-btn",{attrs:{disabled:""===e.inputtedUserName,large:"",color:"primary"},on:{click:e.formatNameAndEmitEvent}},[s("v-icon",[e._v("mdi-account-plus")])],1)],1)],1)],1)},ht=[],ft=(s("4d63"),s("25f0"),s("4de4"),s("466d"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-text-field",{attrs:{type:"text",label:"ユーザー名",filled:"",placeholder:"割勘 太郎",height:"40px","hide-details":"",value:e.value},on:{input:function(t){return e.$emit("input",t)}}})}),vt=[],yt={name:"userTextField",props:["value"]},wt=yt,gt=Object(y["a"])(wt,ft,vt,!1,null,null,null),bt=gt.exports;g()(gt,{VTextField:b["a"]});var kt={name:"appendUserForm",components:{userTextField:bt},props:["userNameList"],data:function(){return{inputtedUserName:""}},methods:{formatNameAndEmitEvent:function(){var e=this.inputtedUserName,t=new RegExp("^"+e+"(_[0-9]*)?$"),s=this.userNameList.filter((function(e){return null!==e.match(t)})),n=s.length;n>0&&(e=this.inputtedUserName+"_"+(n+1)),this.$emit("appendUserEvent",e),this.inputtedUserName=""}}},_t=kt,Nt=Object(y["a"])(_t,pt,ht,!1,null,"162d1e92",null),Ct=Nt.exports;g()(Nt,{VBtn:L["a"],VCol:K["a"],VContainer:$["a"],VIcon:F["a"],VRow:V["a"]});var xt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",[e.userNameList.length<2?s("div",{attrs:{id:"id_user_shortage"}},[s("p",[e._v("受け渡し機能を使うには2人以上のユーザーを追加してください")])]):e._e(),e.userNameList.length>=2?s("div",[s("v-row",{staticClass:"pa-3"},[s("moneyTextField",{model:{value:e.paymentAmount,callback:function(t){e.paymentAmount=e._n(t)},expression:"paymentAmount"}})],1),s("v-row",{attrs:{align:"center"}},[s("v-col",[s("v-select",{attrs:{items:e.userNameList,filled:"",label:"払う人","hide-details":""},model:{value:e.payer,callback:function(t){e.payer=t},expression:"payer"}})],1),s("v-col",[s("v-select",{attrs:{items:e.userNameList,filled:"",label:"受け取る人","hide-details":""},model:{value:e.receiver,callback:function(t){e.receiver=t},expression:"receiver"}})],1),s("v-col",[s("v-btn",{attrs:{color:"warning","x-large":"",disabled:!e.readyToRepayment},on:{click:e.repayment}},[s("v-icon",{attrs:{color:"black"}},[e._v("mdi-cash-refund")])],1)],1)],1)],1):e._e()])},Pt=[],Lt={name:"repaymentForm",components:{moneyTextField:_},props:["userNameList"],data:function(){return{payer:"",receiver:"",paymentAmount:""}},computed:{readyToRepayment:function(){var e=""!=this.paymentAmount,t=""!=this.payer&&""!=this.receiver,s=this.payer!=this.receiver;return e&&t&&s}},methods:{repayment:function(){var e=Math.floor(this.paymentAmount);this.$emit("repaymentEvent",{payer:this.payer,receiver:this.receiver,amount:e}),this.paymentAmount="",this.payer="",this.receiver=""}}},Et=Lt,$t=(s("43cf"),s("b974")),Ft=Object(y["a"])(Et,xt,Pt,!1,null,"47b87cac",null),Vt=Ft.exports;g()(Ft,{VBtn:L["a"],VCol:K["a"],VContainer:$["a"],VIcon:F["a"],VRow:V["a"],VSelect:$t["a"]});var Tt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.shareFlag?s("shareSessionConfirmModal",{on:{shareConfirmEvent:e.emitShareEvent,shareCancelEvent:function(t){e.shareFlag=!1}}}):e._e(),e.loadFlag?s("confirmModal",{attrs:{confirmContents:"サーバからデータを読み込むと「共有」していないデータは消えてしまいます．よろしいですか？"},on:{confirmEvent:e.emitLoadEvent,cancelEvent:function(t){e.loadFlag=!1}}}):e._e(),e.disconnectConfirmFlag?s("confirmModal",{attrs:{confirmContents:e.disconnectConfirmContent},on:{confirmEvent:e.disconnectSession,cancelEvent:function(t){e.disconnectConfirmFlag=!1}}}):e._e(),s("v-container",[s("v-row",{attrs:{align:"center"}},[s("v-col",[s("sessionNameTextField",{model:{value:e.sessionName,callback:function(t){e.sessionName=t},expression:"sessionName"}})],1),s("v-col",[s("v-btn",{on:{click:e.checkSessionNameAndEmitShareEvent}},[e._v("共有")]),s("v-btn",{on:{click:e.checkSessionNameAndEmitLoadEvent}},[e._v("読込")]),s("v-btn",{on:{click:function(t){e.disconnectConfirmFlag=!0}}},[e._v("クリア")])],1)],1),s("v-row",[e.isError?s("p",{staticClass:"textFieldError"},[e._v(e._s(e.errorMessage))]):e._e()])],1)],1)},jt=[],St=(s("159b"),s("ddb0"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-text-field",{attrs:{type:"text",label:"セッション名",filled:"",placeholder:"夏旅行20XX",height:"40px","hide-details":"",value:e.value},on:{input:function(t){return e.$emit("input",t)}}})}),At=[],Ut={name:"userTextField",props:["value"]},It=Ut,Mt=Object(y["a"])(It,St,At,!1,null,null,null),Kt=Mt.exports;g()(Mt,{VTextField:b["a"]});var Ot=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal_overlay"},[s("v-card",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.cancelSharing,expression:"cancelSharing"}],staticClass:"modal_contents",attrs:{color:"white"}},[s("v-container",[s("v-row",{attrs:{justify:"center",align:"center"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.enablePassword,expression:"enablePassword"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.enablePassword)?e._i(e.enablePassword,null)>-1:e.enablePassword},on:{change:function(t){var s=e.enablePassword,n=t.target,a=!!n.checked;if(Array.isArray(s)){var o=null,r=e._i(s,o);n.checked?r<0&&(e.enablePassword=s.concat([o])):r>-1&&(e.enablePassword=s.slice(0,r).concat(s.slice(r+1)))}else e.enablePassword=a}}}),s("span",{staticClass:"px-1"},[e._v("パスワードを設定する")])]),s("v-row",{attrs:{justify:"center"}},[s("passwordTextField",{attrs:{enablePassword:e.enablePassword},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),s("v-row",{attrs:{justify:"center"}},[s("v-btn",{on:{click:e.cancelSharing}},[e._v(" キャンセル ")]),s("v-btn",{attrs:{disabled:e.password.length<8&&e.enablePassword},on:{click:e.confirmSharing}},[e._v(" 共有 ")])],1)],1)],1)],1)},Rt=[],Bt={name:"shareSessionConfirmModal",components:{passwordTextField:Ee},data:function(){return{password:"",enablePassword:!0}},methods:{confirmSharing:function(){this.enablePassword?this.$emit("shareConfirmEvent",this.password):this.$emit("shareConfirmEvent","")},cancelSharing:function(){this.$emit("shareCancelEvent")}}},Dt=Bt,Ht=Object(y["a"])(Dt,Ot,Rt,!1,null,null,null),zt=Ht.exports;g()(Ht,{VBtn:L["a"],VCard:E["a"],VContainer:$["a"],VRow:V["a"]}),j()(Ht,{ClickOutside:S["a"]});var qt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal_overlay"},[s("v-card",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.cancel,expression:"cancel"}],staticClass:"modal_contents",attrs:{color:"white"}},[s("v-container",[s("v-row",{attrs:{justify:"center"}},[s("p",[e._v(" "+e._s(e.confirmContents)+" ")])]),s("v-row",{attrs:{justify:"center"}},[s("v-btn",{on:{click:e.cancel}},[e._v(" キャンセル ")]),s("v-btn",{on:{click:e.confirm}},[e._v(" 実行 ")])],1)],1)],1)],1)},Jt=[],Wt={name:"confirmModal",props:["confirmContents"],data:function(){return{}},methods:{confirm:function(){this.$emit("confirmEvent")},cancel:function(){this.$emit("cancelEvent")}}},Xt=Wt,Gt=Object(y["a"])(Xt,qt,Jt,!1,null,null,null),Qt=Gt.exports;g()(Gt,{VBtn:L["a"],VCard:E["a"],VContainer:$["a"],VRow:V["a"]}),j()(Gt,{ClickOutside:S["a"]});var Yt={name:"shareAndLoadForm",components:{sessionNameTextField:Kt,shareSessionConfirmModal:zt,confirmModal:Qt},props:[""],data:function(){return{sessionName:"",errorMessage:"",isError:!1,shareFlag:!1,loadFlag:!1,disconnectConfirmFlag:!1}},computed:{disconnectConfirmContent:function(){var e=this.$cookies.isKey(_e.a.sessionNameKey);if(e){var t=this.$cookies.get(_e.a.sessionNameKey);return"セッション（".concat(t,"）の接続を解除します．よろしいですか？（サーバにデータは残ります．）")}return"セッション接続がないため，ローカルのデータが破棄されます．よろしいですか？"}},methods:{checkSessionNameAndEmitShareEvent:function(){var e={method:"post",url:"dbAPI/checkSessionName",responseType:"json",headers:{"Content-Type":"application/json"},data:{sessionName:this.sessionName}},t=this;u()(e).then((function(e){console.log(e.data.result),e.data.result===_e.a.sessionNameDuplicate?(t.errorMessage="そのセッション名は使われています",t.isError=!0):(t.isError=!1,t.shareFlag=!0)})).catch((function(e){console.log(e)})).finally((function(){t=null}))},checkSessionNameAndEmitLoadEvent:function(){var e={method:"post",url:"dbAPI/checkSessionName",responseType:"json",headers:{"Content-Type":"application/json"},data:{sessionName:this.sessionName}},t=this;u()(e).then((function(e){console.log(e.data.result),e.data.result===_e.a.sessionNameDuplicate?(t.loadFlag=!0,t.isError=!1):(t.errorMessage="そのセッションは存在しません",t.isError=!0)})).catch((function(e){console.log(e)})).finally((function(){t=null}))},emitShareEvent:function(e){this.$emit("shareEvent",{password:e,sessionName:this.sessionName}),this.shareFlag=!1},emitLoadEvent:function(){this.$emit("loadEvent",this.sessionName),this.loadFlag=!1},disconnectSession:function(){var e=this;this.$cookies.keys().forEach((function(t){return e.$cookies.remove(t)})),this.disconnectConfirmFlag=!1,this.$emit("disconnectEvent")}}},Zt=Yt,es=(s("7b38"),Object(y["a"])(Zt,Tt,jt,!1,null,"04eaaa89",null)),ts=es.exports;g()(es,{VBtn:L["a"],VCol:K["a"],VContainer:$["a"],VRow:V["a"]});var ss=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",[s("p",[e._v("仮置")])])},ns=[],as={name:"tippingForm",components:{},methods:{}},os=as,rs=Object(y["a"])(os,ss,ns,!1,null,"249d452a",null),is=rs.exports;g()(rs,{VContainer:$["a"]}),n["a"].use(mt["a"]);var cs=[{path:"/",name:"appendUserForm",component:Ct},{path:"/repaymentForm",name:"repaymentForm",component:Vt},{path:"/shareAndLoadForm",name:"shareAndLoadForm",component:ts},{path:"/tippingForm",name:"tippingForm",component:is}],ls=new mt["a"]({mode:"history",base:"/",routes:cs}),us=ls,ds=s("2106"),ms=s.n(ds),ps=s("2b27"),hs=s.n(ps);s("5363");n["a"].config.productionTip=!1,n["a"].use(ms.a,u.a),n["a"].use(hs.a),new n["a"]({icons:{iconfont:"mdi"},vuetify:dt,router:us,render:function(e){return e(lt)}}).$mount("#app")},"5fb0":function(e,t){e.exports={sessionNameDuplicate:"snd",success:"success",error:"error",sessionNameKey:"sessionName",passwordKey:"password",userNameListKey:"userNameList",paymentListKey:"paymentList",wrongPassword:"wp",throughPassword:"",wrongPasswordMessage:"パスワードが違います．再度セッションを読み込んでください",appURL:"https://wa-warikan.herokuapp.com"}},7910:function(e,t,s){},"7a75":function(e,t,s){e.exports=s.p+"img/支払い加算.34975b4b.png"},"7b38":function(e,t,s){"use strict";s("2ad6")},"7c1c":function(e,t,s){},"85ec":function(e,t,s){},"92c1":function(e,t,s){e.exports=s.p+"img/helpPayment.c00de9e6.png"},a35e:function(e,t,s){"use strict";s("b17a")},b0e3:function(e,t,s){e.exports=s.p+"img/helpAppendUser.84084f7d.png"},b17a:function(e,t,s){},b403:function(e,t,s){},b77f:function(e,t,s){},c8a3:function(e,t,s){"use strict";s("4520")},e5b8:function(e,t,s){"use strict";s("7c1c")},ed2b:function(e,t,s){},f5df1:function(e,t,s){"use strict";s("b403")},f634:function(e,t,s){"use strict";s("7910")},f909:function(e,t,s){"use strict";s("ed2b")}});
//# sourceMappingURL=app.6eb5a3e5.js.map